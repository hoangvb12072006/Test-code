<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÄÄƒng Nháº­p - Há»‡ Thá»‘ng Quáº£n LÃ½</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>

    <nav class="navbar">
        <div class="logo">
            <i class="fas fa-school"></i> TRÆ¯á»œNG CAO Äáº²NG KÄ¨ THUáº¬T
        </div>
        <div class="menu">
            <a href="index.html" class="nav-btn"><i class="fas fa-home"></i> Trang Chá»§</a>
            <a href="tracuudiem.html" class="nav-btn"><i class="fas fa-search"></i> Tra Cá»©u Äiá»ƒm</a>
            <a href="gioithieu.html" class="nav-btn"><i class="fas fa-info-circle"></i> ThÃ´ng Tin</a>
            <a href="login.html" class="nav-btn active"><i class="fas fa-user"></i> ÄÄƒng Nháº­p/ÄÄƒng KÃ½</a>
            <a href="dashboard.html" class="nav-btn"><i class="fas fa-cogs"></i> Quáº£n LÃ½</a>
        </div>
    </nav>

    <main class="auth-container">
        <div class="auth-box">
            <div class="auth-toggle">
                <button class="toggle-btn active" onclick="showLogin()">ÄÄƒng Nháº­p</button>
                <button class="toggle-btn" onclick="showRegister()">ÄÄƒng KÃ½</button>
            </div>

            <form id="loginForm" class="auth-form" onsubmit="handleLogin(event)">
                <h2>ChÃ o má»«ng trá»Ÿ láº¡i!</h2>
                <div class="input-group">
                    <i class="fas fa-user"></i>
                    <input type="text" id="loginUser" placeholder="TÃªn Ä‘Äƒng nháº­p" required>
                </div>
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="loginPass" placeholder="Máº­t kháº©u" required>
                </div>
                <button type="submit" class="auth-submit">ÄÄƒng Nháº­p</button>
            </form>

            <form id="registerForm" class="auth-form" style="display: none;" onsubmit="handleRegister(event)">
                <h2>Táº¡o tÃ i khoáº£n má»›i</h2>
                <div class="input-group">
                    <i class="fas fa-id-badge"></i>
                    <input type="text" id="regId" placeholder="MÃ£ HS/SV (VD: HS001)" required>
                </div>
                <div class="input-group">
                    <i class="fas fa-user"></i>
                    <input type="text" id="regUser" placeholder="TÃªn Ä‘Äƒng nháº­p" required>
                </div>
                <div class="input-group">
                    <i class="fas fa-lock"></i>
                    <input type="password" id="regPass" placeholder="Máº­t kháº©u" required>
                </div>
                <button type="submit" class="auth-submit">ÄÄƒng KÃ½</button>
            </form>
        </div>
    </main>

    <script src="script.js"></script>
    <script>
        // 1. Giao diá»‡n: Chuyá»ƒn Ä‘á»•i qua láº¡i giá»¯a ÄÄƒng nháº­p & ÄÄƒng kÃ½
        function showLogin() {
            document.getElementById('loginForm').style.display = 'block';
            document.getElementById('registerForm').style.display = 'none';
            document.querySelectorAll('.toggle-btn')[0].classList.add('active');
            document.querySelectorAll('.toggle-btn')[1].classList.remove('active');
        }
        function showRegister() {
            document.getElementById('loginForm').style.display = 'none';
            document.getElementById('registerForm').style.display = 'block';
            document.querySelectorAll('.toggle-btn')[0].classList.remove('active');
            document.querySelectorAll('.toggle-btn')[1].classList.add('active');
        }

        // 2. Logic: Danh sÃ¡ch mÃ£ há»£p lá»‡ giáº£ láº­p
        const validIDs = ["HS001", "HS002", "HS003", "GV001", "GV002", "HOANGKUN"];

        // 3. Logic: Xá»­ lÃ½ ÄÄƒng kÃ½
        function handleRegister(event) {
            event.preventDefault(); 
            const studentId = document.getElementById('regId').value.trim().toUpperCase();
            const username = document.getElementById('regUser').value.trim();
            const pass = document.getElementById('regPass').value;

            if (!validIDs.includes(studentId)) {
                alert("âŒ MÃ£ sá»‘ khÃ´ng há»£p lá»‡! Vui lÃ²ng nháº­p Ä‘Ãºng mÃ£ trÆ°á»ng cáº¥p.");
                return;
            }

            let users = JSON.parse(localStorage.getItem('school_users')) || [];
            
            const isExist = users.find(u => u.studentId === studentId || u.username === username);
            if (isExist) {
                alert("âš ï¸ MÃ£ sá»‘ hoáº·c tÃªn Ä‘Äƒng nháº­p nÃ y Ä‘Ã£ Ä‘Æ°á»£c Ä‘Äƒng kÃ½!");
                return;
            }

            users.push({ studentId, username, pass });
            localStorage.setItem('school_users', JSON.stringify(users));
            
            alert("âœ… ÄÄƒng kÃ½ thÃ nh cÃ´ng! Báº¡n cÃ³ thá»ƒ Ä‘Äƒng nháº­p ngay.");
            document.getElementById('registerForm').reset();
            showLogin();
        }

        // 4. Logic: Xá»­ lÃ½ ÄÄƒng nháº­p
        function handleLogin(event) {
            event.preventDefault();
            const username = document.getElementById('loginUser').value.trim();
            const pass = document.getElementById('loginPass').value;

            let users = JSON.parse(localStorage.getItem('school_users')) || [];
            const validUser = users.find(u => u.username === username && u.pass === pass);

            if (validUser) {
                alert("ğŸ‰ ÄÄƒng nháº­p thÃ nh cÃ´ng! ChÃ o má»«ng " + username);
                localStorage.setItem('currentUser', JSON.stringify(validUser)); 
                window.location.href = 'dashboard.html'; 
            } else {
                alert("âŒ Sai tÃªn Ä‘Äƒng nháº­p hoáº·c máº­t kháº©u!");
            }
        }
    </script>
</body>
</html>
